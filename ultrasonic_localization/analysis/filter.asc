Version 4
SHEET 1 1124 680
WIRE 512 -80 432 -80
WIRE 448 -64 432 -64
WIRE 512 -64 512 -80
WIRE 816 -16 768 -16
WIRE 432 0 432 -64
WIRE 512 0 512 -64
WIRE -32 48 -32 -48
WIRE -32 48 -160 48
WIRE 32 48 -32 48
WIRE 176 48 176 -16
WIRE 192 48 176 48
WIRE 368 48 368 -80
WIRE 368 48 336 48
WIRE 432 48 432 0
WIRE 448 48 432 48
WIRE 656 48 656 -16
WIRE 672 48 656 48
WIRE 256 64 256 -16
WIRE 336 64 336 48
WIRE 512 64 512 0
WIRE 656 64 656 48
WIRE 736 64 736 -16
WIRE 768 64 768 -16
WIRE 768 64 736 64
WIRE 192 80 176 80
WIRE 448 80 432 80
WIRE 672 80 656 80
WIRE 128 144 80 144
WIRE 176 144 176 80
WIRE 176 144 128 144
WIRE 336 144 176 144
WIRE 432 144 432 80
WIRE 432 144 336 144
WIRE 656 144 656 80
WIRE 656 144 432 144
WIRE 736 144 672 144
WIRE 864 144 816 144
WIRE 896 144 864 144
WIRE -368 160 -464 160
WIRE -160 160 -160 128
WIRE 480 224 448 224
WIRE 640 224 480 224
WIRE 656 224 640 224
WIRE 688 224 656 224
WIRE 816 240 752 240
WIRE 672 256 672 144
WIRE 688 256 672 256
WIRE 864 272 864 144
WIRE 944 272 864 272
WIRE 880 320 816 320
WIRE 944 400 944 368
FLAG -160 160 0
FLAG -192 -48 5V
FLAG -192 32 0
FLAG 80 208 0
FLAG 128 208 0
FLAG -464 240 0
FLAG -464 80 5V
FLAG -368 160 VGND
FLAG 80 144 VGND
FLAG 448 304 0
FLAG 480 288 0
FLAG 640 304 THRESH
FLAG 224 96 0
FLAG 224 32 5V
FLAG 480 32 5V
FLAG 704 32 5V
FLAG 720 208 5V
FLAG 480 96 0
FLAG 704 96 0
FLAG 720 272 0
FLAG 816 64 5V
FLAG 816 400 0
FLAG 944 400 0
FLAG -464 -48 THRESH
FLAG -464 32 0
FLAG -32 -48 IN
FLAG 896 144 SIG2
FLAG 816 -16 SIG
SYMBOL res 16 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 10K
SYMBOL cap 176 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 10nF
SYMBOL res 160 0 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 57 89 VBottom 2
SYMATTR InstName R
SYMATTR Value 62K
SYMBOL res 240 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 660
SYMBOL voltage -192 -64 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL res 320 48 R0
SYMATTR InstName R4
SYMATTR Value 1K
SYMBOL cap 112 144 R0
SYMATTR InstName C2
SYMATTR Value 150nF
SYMBOL cap 64 144 R0
SYMATTR InstName C3
SYMATTR Value 1.2µF
SYMBOL res -480 64 R0
SYMATTR InstName R5
SYMATTR Value 1K
SYMBOL res -480 144 R0
SYMATTR InstName R6
SYMATTR Value 1K
SYMBOL cap 432 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1nF
SYMBOL cap 368 -64 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value 1nF
SYMBOL cap 512 -80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 3 -20 VTop 2
SYMATTR InstName C6
SYMATTR Value 12pF
SYMBOL res 416 16 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 29 118 VBottom 2
SYMATTR InstName R7
SYMATTR Value 40K
SYMBOL res 496 80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -10 57 VBottom 2
SYMATTR InstName R8
SYMATTR Value 10K
SYMBOL cap 592 80 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C7
SYMATTR Value 10nF
SYMBOL res 640 0 R270
WINDOW 0 37 32 VTop 2
WINDOW 3 60 79 VBottom 2
SYMATTR InstName R9
SYMATTR Value 75K
SYMBOL res 720 48 R0
WINDOW 0 124 27 VRight 2
WINDOW 3 47 13 VRight 2
SYMATTR InstName R10
SYMATTR Value 4.53K
SYMBOL res 672 240 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 120K
SYMBOL cap 464 224 R0
SYMATTR InstName C8
SYMATTR Value 10nF
SYMBOL res 464 320 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R12
SYMATTR Value 3.3Meg
SYMBOL res 656 320 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 75K
SYMBOL res 832 128 R90
WINDOW 0 57 4 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 120K
SYMBOL res 832 160 R180
WINDOW 0 43 52 VRight 2
WINDOW 3 -37 39 VRight 2
SYMATTR InstName R15
SYMATTR Value 10K
SYMBOL npn 880 272 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 832 336 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R16
SYMATTR Value 10K
SYMBOL res 832 416 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 3.9K
SYMBOL voltage -160 32 R0
WINDOW 3 -144 162 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value SINE(0 0.1 {freq})
SYMATTR InstName V2
SYMBOL voltage -464 -64 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 0V
SYMBOL Opamps\\UniversalOpamp2 224 64 R0
SYMATTR InstName U1
SYMBOL Opamps\\UniversalOpamp2 480 64 R0
SYMATTR InstName U2
SYMBOL Opamps\\UniversalOpamp2 704 64 R0
SYMATTR InstName U3
SYMBOL Opamps\\UniversalOpamp2 720 240 R0
SYMATTR InstName U4
TEXT -856 -424 Left 2 !.measure avg_in avg V(IN)\n.measure avg_sig avg V(SIG)\n.measure re_in avg (V(IN)-avg_in)*cos(360*time*freq)\n.measure im_in avg -(V(IN)-avg_in)*sin(360*time*freq)\n.measure re_sig avg (V(SIG)-avg_sig)*cos(360*time*freq)\n.measure im_sig avg -(V(SIG)-avg_sig)*sin(360*time*freq)\n.measure GainMag param hypot(re_sig,im_sig)/hypot(re_in,im_in)
TEXT 80 -432 Left 2 !.param t0=.2m
TEXT 48 -328 Left 2 !.tran 0 {t0+25/freq} {t0}
TEXT 40 -280 Left 2 ;.step oct param freq 5K 500K 5
TEXT 40 -224 Left 2 ;.save V(IN) V(SIG) V(SIG2)\n.option plotwinsize=0 numdgt=15
TEXT 424 -376 Left 2 !.param freq=400K
